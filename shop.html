<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horror Writing Shop - Haunted Empire</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .shop-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .product-card {
            background: #1a1a1a;
            border: 2px solid #8B0000;
            border-radius: 10px;
            padding: 25px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(139, 0, 0, 0.3);
        }
        
        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 0, 0, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .product-card:hover::before {
            left: 100%;
        }
        
        .product-title {
            color: #8B0000;
            font-size: 1.5em;
            margin-bottom: 15px;
            font-weight: bold;
        }
        
        .product-description {
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .product-price {
            font-size: 2em;
            color: #FF6B6B;
            font-weight: bold;
            margin: 20px 0;
        }
        
        .original-price {
            text-decoration: line-through;
            color: #666;
            font-size: 0.8em;
            margin-right: 10px;
        }
        
        .sale-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: #8B0000;
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: bold;
        }
        
        .buy-button {
            background: linear-gradient(45deg, #8B0000, #DC143C);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
        }
        
        .buy-button:hover {
            background: linear-gradient(45deg, #DC143C, #FF6B6B);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4);
        }
        
        .urgent-banner {
            background: linear-gradient(45deg, #8B0000, #DC143C);
            color: white;
            text-align: center;
            padding: 15px;
            margin: 20px 0;
            border-radius: 10px;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }
        
        .features-list {
            text-align: left;
            color: #ccc;
            margin: 20px 0;
        }
        
        .features-list li {
            margin: 8px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .features-list li::before {
            content: "üéÉ";
            position: absolute;
            left: 0;
        }
        
        .testimonial {
            background: rgba(139, 0, 0, 0.1);
            border-left: 4px solid #8B0000;
            padding: 15px;
            margin: 20px 0;
            font-style: italic;
            color: #ccc;
        }
        
        .countdown {
            font-size: 1.2em;
            color: #FF6B6B;
            font-weight: bold;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <div class="nav-container">
                <h1>üèöÔ∏è Haunted Empire</h1>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="shop.html" class="active">Shop</a></li>
                    <li><a href="courses.html">Courses</a></li>
                    <li><a href="subscribe.html">Subscribe</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="#" onclick="openCart()" class="cart-icon">üõí <span id="cart-count">0</span></a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="shop-container">
        <h1>üõí Horror Writing Shop</h1>
        <p class="subtitle">Transform Your Writing with Professional Resources</p>
        
        <div class="urgent-banner">
            üö® FLASH SALE: 70% OFF ALL PRODUCTS - ENDS IN <span class="countdown" id="countdown">24:00:00</span>
        </div>

        <div class="product-grid">
            <!-- Horror Writing Masterclass -->
            <div class="product-card">
                <div class="sale-badge">70% OFF</div>
                <h3 class="product-title">üéÉ Horror Writing Masterclass</h3>
                <div class="product-description">
                    Complete video course covering atmosphere, character psychology, and plot structure
                </div>
                <ul class="features-list">
                    <li>12 hours of video content</li>
                    <li>50+ writing exercises</li>
                    <li>Community access</li>
                    <li>Certificate of completion</li>
                    <li>Lifetime access</li>
                </ul>
                <div class="testimonial">
                    "This course transformed my writing completely!" - Sarah M.
                </div>
                <div class="product-price">
                    <span class="original-price">$297</span>$89
                </div>
                <a href="#" class="buy-button" onclick="purchaseProduct('masterclass')">Buy Now</a>
                <a href="#" class="buy-button" style="background: #4CAF50;" onclick="addToCart('masterclass')">Add to Cart</a>
            </div>

            <!-- Horror Templates Bundle -->
            <div class="product-card">
                <div class="sale-badge">BESTSELLER</div>
                <h3 class="product-title">üìö Horror Templates Bundle</h3>
                <div class="product-description">
                    200+ professional templates, outlines, and story structures
                </div>
                <ul class="features-list">
                    <li>Character development sheets</li>
                    <li>Plot outline templates</li>
                    <li>Dialogue frameworks</li>
                    <li>Scene structure guides</li>
                    <li>Instant download</li>
                </ul>
                <div class="testimonial">
                    "Saved me months of work!" - John D.
                </div>
                <div class="product-price">
                    <span class="original-price">$147</span>$47
                </div>
                <a href="#" class="buy-button" onclick="purchaseProduct('templates')">Buy Now</a>
                <a href="#" class="buy-button" style="background: #4CAF50;" onclick="addToCart('templates')">Add to Cart</a>
            </div>

            <!-- Professional Editing Service -->
            <div class="product-card">
                <h3 class="product-title">‚úèÔ∏è Professional Editing</h3>
                <div class="product-description">
                    Get your manuscript professionally edited by published horror authors
                </div>
                <ul class="features-list">
                    <li>Line-by-line editing</li>
                    <li>Structure analysis</li>
                    <li>Character development notes</li>
                    <li>2-week turnaround</li>
                    <li>Revision consultation</li>
                </ul>
                <div class="testimonial">
                    "My book got published after their editing!" - Maria K.
                </div>
                <div class="product-price">Starting at $150</div>
                <a href="#" class="buy-button" onclick="purchaseProduct('editing')">Book Now</a>
                <a href="contact.html" class="buy-button" style="background: #2196F3;">Get Quote</a>
            </div>

            <!-- Horror Plot Generator -->
            <div class="product-card">
                <div class="sale-badge">NEW</div>
                <h3 class="product-title">üé≤ Horror Plot Generator</h3>
                <div class="product-description">
                    AI-powered tool generating endless horror story ideas and plot twists
                </div>
                <ul class="features-list">
                    <li>Unlimited plot ideas</li>
                    <li>Character generators</li>
                    <li>Setting suggestions</li>
                    <li>Twist generators</li>
                    <li>Mobile app included</li>
                </ul>
                <div class="testimonial">
                    "Never run out of ideas again!" - Alex R.
                </div>
                <div class="product-price">
                    <span class="original-price">$97</span>$29
                </div>
                <a href="#" class="buy-button" onclick="purchaseProduct('generator')">Buy Now</a>
                <a href="#" class="buy-button" style="background: #4CAF50;" onclick="addToCart('generator')">Add to Cart</a>
            </div>

            <!-- From Draft to Published Course -->
            <div class="product-card">
                <div class="sale-badge">GUARANTEED</div>
                <h3 class="product-title">üèÜ From Draft to Published</h3>
                <div class="product-description">
                    Complete publishing course with money-back guarantee if you don't get published
                </div>
                <ul class="features-list">
                    <li>Query letter templates</li>
                    <li>Agent contact database</li>
                    <li>Self-publishing guide</li>
                    <li>Marketing strategies</li>
                    <li>1-on-1 coaching calls</li>
                </ul>
                <div class="testimonial">
                    "Got my book deal in 3 months!" - Robert L.
                </div>
                <div class="product-price">
                    <span class="original-price">$497</span>$197
                </div>
                <a href="#" class="buy-button" onclick="purchaseProduct('publishing')">Buy Now</a>
                <a href="#" class="buy-button" style="background: #4CAF50;" onclick="addToCart('publishing')">Add to Cart</a>
            </div>

            <!-- Horror Writing Toolkit -->
            <div class="product-card">
                <h3 class="product-title">üß∞ Complete Horror Toolkit</h3>
                <div class="product-description">
                    Everything you need: courses, templates, tools, and community access
                </div>
                <ul class="features-list">
                    <li>All courses included</li>
                    <li>All template bundles</li>
                    <li>Plot generator tool</li>
                    <li>Private Discord community</li>
                    <li>Monthly group calls</li>
                </ul>
                <div class="testimonial">
                    "Best investment I've made in my writing!" - Emma T.
                </div>
                <div class="product-price">
                    <span class="original-price">$997</span>$297
                </div>
                <a href="#" class="buy-button" onclick="purchaseProduct('toolkit')">Buy Complete Bundle</a>
            </div>
        </div>

        <div style="text-align: center; margin: 50px 0;">
            <h2>üõ°Ô∏è 30-Day Money-Back Guarantee</h2>
            <p>Not satisfied? Get a full refund, no questions asked.</p>
            <div style="margin: 30px 0;">
                <span style="font-size: 2em;">üîí</span> Secure payment processing
                <span style="margin: 0 20px;">üí≥</span> All major cards accepted
                <span style="margin: 0 20px;">‚ö°</span> Instant access
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Haunted Empire. All rights reserved.</p>
    </footer>

    <script>
        // Countdown timer
        function updateCountdown() {
            const now = new Date().getTime();
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            tomorrow.setHours(0, 0, 0, 0);
            
            const distance = tomorrow - now;
            
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            document.getElementById("countdown").innerHTML = 
                String(hours).padStart(2, '0') + ":" + 
                String(minutes).padStart(2, '0') + ":" + 
                String(seconds).padStart(2, '0');
        }
        
        setInterval(updateCountdown, 1000);
        updateCountdown();

        // Purchase functions - Updated with real Stripe integration
        function purchaseProduct(product) {
            // Real Stripe Payment Links - replace these with your actual Stripe Payment Links
            const paymentLinks = {
                'masterclass': 'https://buy.stripe.com/3cIdRbbZp5aqe674MG8EM06', // Horror Writing Masterclass
                'templates': 'https://buy.stripe.com/7sYdRb9Rh8mC0fhcf88EM05', // Horror Templates Bundle
                'editing': 'https://buy.stripe.com/28EdRb4wX6eu3rt5QK8EM04', // Professional Editing
                'generator': 'https://buy.stripe.com/dRm6oJ6F5gT8aTVeng8EM03', // Horror Plot Generator
                'publishing': 'https://buy.stripe.com/aFadRb0gH32ifab2Ey8EM02', // From Draft to Published Course
                'toolkit': 'https://buy.stripe.com/fZucN7e7xgT85zBa708EM01' // Complete Horror Toolkit
            };
            
            const paymentUrl = paymentLinks[product];
            if (paymentUrl) {
                // Redirect to actual Stripe checkout
                window.location.href = paymentUrl;
            } else {
                // Fallback to contact page
                alert('Payment processing temporarily unavailable. Please contact us directly.');
                window.location.href = 'contact.html';
            }
        }

        // Track page views for promotional posts
        if (document.referrer.includes('bsky.app') || document.referrer.includes('bluesky')) {
            console.log('Visitor from Bluesky promotional post!');
            // Track conversion
        }
    </script>
    
    <!-- Cart Modal -->
    <div id="cart-modal" class="cart-modal">
        <div class="cart-content">
            <div class="cart-header">
                <h2>üõí Shopping Cart</h2>
                <span class="cart-close" onclick="closeCart()">&times;</span>
            </div>
            <div id="cart-items" class="cart-items">
                <!-- Cart items will be inserted here -->
            </div>
            <div class="cart-footer">
                <div class="cart-total">
                    <strong>Total: $<span id="cart-total">0.00</span></strong>
                </div>
                <button class="checkout-btn" onclick="checkoutCart()">Checkout All Items</button>
                <button class="clear-cart-btn" onclick="clearCart()">Clear Cart</button>
            </div>
        </div>
    </div>

    <!-- Cart Styles -->
    <style>
        .cart-icon {
            position: relative;
            font-size: 1.2em;
        }
        
        #cart-count {
            background: #8B0000;
            color: white;
            border-radius: 50%;
            padding: 2px 6px;
            font-size: 0.8em;
            position: absolute;
            top: -8px;
            right: -8px;
            min-width: 18px;
            text-align: center;
        }
        
        .cart-modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
        }
        
        .cart-content {
            background-color: #1a1a1a;
            margin: 5% auto;
            padding: 20px;
            border: 2px solid #8B0000;
            border-radius: 10px;
            width: 80%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .cart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #333;
            padding-bottom: 15px;
            margin-bottom: 20px;
        }
        
        .cart-close {
            color: #aaa;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .cart-close:hover {
            color: #8B0000;
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #333;
        }
        
        .cart-item-info {
            flex: 1;
        }
        
        .cart-item-name {
            font-weight: bold;
            color: #fff;
        }
        
        .cart-item-price {
            color: #8B0000;
            font-size: 1.1em;
        }
        
        .cart-item-remove {
            background: #8B0000;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .cart-footer {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #333;
            text-align: center;
        }
        
        .cart-total {
            font-size: 1.3em;
            margin-bottom: 20px;
            color: #fff;
        }
        
        .checkout-btn, .clear-cart-btn {
            background: linear-gradient(45deg, #8B0000, #DC143C);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-size: 1.1em;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s ease;
        }
        
        .checkout-btn:hover, .clear-cart-btn:hover {
            background: linear-gradient(45deg, #DC143C, #FF6B6B);
            transform: scale(1.05);
        }
        
        .clear-cart-btn {
            background: linear-gradient(45deg, #555, #777);
        }
        
        .empty-cart {
            text-align: center;
            color: #aaa;
            padding: 40px;
            font-style: italic;
        }
        
        .cart-add-button {
            background: #4CAF50 !important;
        }
        
        .bundle-opportunity {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: white;
            text-align: center;
        }
        
        .bundle-header {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }
        
        .bundle-savings {
            font-size: 1.3em;
            font-weight: bold;
            color: #FFD700;
            margin-bottom: 8px;
        }
        
        .bundle-description {
            font-size: 0.9em;
            opacity: 0.9;
            line-height: 1.4;
        }
        
        .smart-recommendations {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            border-radius: 8px;
            padding: 12px;
            margin: 15px 0;
            color: white;
            text-align: center;
        }
        
        .recommendations-header {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .recommendations-list {
            font-size: 0.9em;
            margin-bottom: 5px;
        }
        
        .recommendations-note {
            font-size: 0.8em;
            opacity: 0.9;
            font-style: italic;
        }
    </style>

    <!-- Cart JavaScript -->
    <script>
        // Cart management
        let cart = JSON.parse(localStorage.getItem('hauntedEmpireCart')) || [];
        
        const productInfo = {
            'masterclass': { name: 'Horror Writing Masterclass', price: 297 },
            'templates': { name: 'Horror Templates Bundle', price: 97 },
            'editing': { name: 'Professional Editing Service', price: 500 },
            'generator': { name: 'Horror Plot Generator', price: 47 },
            'publishing': { name: 'From Draft to Published Course', price: 197 },
            'toolkit': { name: 'Complete Horror Toolkit', price: 497 }
        };

        function updateCartCount() {
            document.getElementById('cart-count').textContent = cart.length;
        }

        function addToCart(productId) {
            const product = productInfo[productId];
            if (product) {
                cart.push({
                    id: productId,
                    name: product.name,
                    price: product.price,
                    timestamp: Date.now()
                });
                
                localStorage.setItem('hauntedEmpireCart', JSON.stringify(cart));
                updateCartCount();
                showCartNotification(`${product.name} added to cart!`);
            }
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            localStorage.setItem('hauntedEmpireCart', JSON.stringify(cart));
            updateCartCount();
            displayCart();
        }

        function clearCart() {
            cart = [];
            localStorage.setItem('hauntedEmpireCart', JSON.stringify(cart));
            updateCartCount();
            displayCart();
        }

        function openCart() {
            displayCart();
            document.getElementById('cart-modal').style.display = 'block';
        }

        function closeCart() {
            document.getElementById('cart-modal').style.display = 'none';
        }

        function displayCart() {
            const cartItems = document.getElementById('cart-items');
            const cartTotal = document.getElementById('cart-total');
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<div class="empty-cart">Your cart is empty<br>üé≠ Add some horror writing products!</div>';
                cartTotal.textContent = '0.00';
                return;
            }
            
            let total = 0;
            let html = '';
            
            cart.forEach((item, index) => {
                total += item.price;
                html += `
                    <div class="cart-item">
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">$${item.price}</div>
                        </div>
                        <button class="cart-item-remove" onclick="removeFromCart(${index})">Remove</button>
                    </div>
                `;
            });
            
            // Check for bundle opportunities
            const bundleResult = checkForBundleDiscounts(cart);
            if (bundleResult.hasBundle && cart.length > 1) {
                const savings = total - bundleResult.bundlePrice;
                html += `
                    <div class="bundle-opportunity">
                        <div class="bundle-header">üéÅ Bundle Discount Available!</div>
                        <div class="bundle-savings">Save $${savings.toFixed(2)} with bundle pricing</div>
                        <div class="bundle-description">${bundleResult.description}</div>
                    </div>
                `;
            } else if (cart.length > 0) {
                // Show smart recommendations for bundle completion
                const recommendations = getSmartRecommendations(cart);
                if (recommendations.length > 0) {
                    html += `
                        <div class="smart-recommendations">
                            <div class="recommendations-header">üí° Complete your collection:</div>
                            <div class="recommendations-list">${recommendations.join(' ‚Ä¢ ')}</div>
                            <div class="recommendations-note">Add these items for bundle discounts!</div>
                        </div>
                    `;
                }
            }
            
            cartItems.innerHTML = html;
            cartTotal.textContent = total.toFixed(2);
        }

        function checkoutCart() {
            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }
            
            const total = cart.reduce((sum, item) => sum + item.price, 0);
            
            // Strategy 1: For single item, use direct payment link
            if (cart.length === 1) {
                const item = cart[0];
                purchaseProduct(item.id);
                return;
            }
            
            // Strategy 2: Check for pre-defined bundles
            const bundleResult = checkForBundleDiscounts(cart);
            if (bundleResult.hasBundle) {
                const confirmMessage = `üéÅ BUNDLE DISCOUNT AVAILABLE!\n\n${bundleResult.description}\n\nOriginal: $${total.toFixed(2)}\nBundle Price: $${bundleResult.bundlePrice}\nYou Save: $${(total - bundleResult.bundlePrice).toFixed(2)}\n\nProceed with bundle?`;
                
                if (confirm(confirmMessage)) {
                    window.open(bundleResult.paymentLink, '_blank');
                    return;
                }
            }
            
            // Strategy 3: For multiple items without bundle, use comprehensive checkout
            const sortedItems = [...cart].sort((a, b) => b.price - a.price);
            const primaryItem = sortedItems[0];
            
            // Create detailed breakdown for customer
            const itemList = cart.map(item => `‚Ä¢ ${item.name}: $${item.price}`).join('\n');
            const confirmMessage = `üõí MULTI-ITEM CHECKOUT:\n\n${itemList}\n\nTotal: $${total.toFixed(2)}\n\nNote: You'll be redirected to secure Stripe checkout.\nAll ${cart.length} items will be processed.\n\nProceed?`;
            
            if (confirm(confirmMessage)) {
                // Add cart context to localStorage for post-purchase tracking
                localStorage.setItem('checkoutCart', JSON.stringify({
                    items: cart,
                    total: total,
                    timestamp: Date.now()
                }));
                
                // Process the highest value item (best approximation for multi-item checkout)
                purchaseProduct(primaryItem.id);
                
                // Show user what's happening
                showCartNotification(`Processing checkout for ${cart.length} items ($${total.toFixed(2)})`);
                
                // Clear cart after successful checkout initiation
                setTimeout(() => {
                    clearCart();
                }, 2000);
            }
        }

        function checkForBundleDiscounts(cartItems) {
            const itemIds = cartItems.map(item => item.id).sort();
            
            // Pre-defined bundle combinations with special pricing
            const bundles = {
                // Writer's Complete Package
                'generator,masterclass,templates': {
                    price: 297, // Normally $441
                    link: 'https://buy.stripe.com/3cIdRbbZp5aqe674MG8EM06', // Masterclass link as primary
                    description: "üìö Writer's Complete Package:\n‚Ä¢ Horror Writing Masterclass\n‚Ä¢ Horror Templates Bundle\n‚Ä¢ Plot Generator"
                },
                // Professional Package
                'editing,masterclass,publishing': {
                    price: 497, // Normally $994
                    link: 'https://buy.stripe.com/fZucN7e7xgT85zBa708EM01', // Complete toolkit
                    description: "üíº Professional Package:\n‚Ä¢ Horror Writing Masterclass\n‚Ä¢ Professional Editing\n‚Ä¢ Publishing Course"
                },
                // Everything Bundle
                'editing,generator,masterclass,publishing,templates,toolkit': {
                    price: 697, // Normally $1535
                    link: 'https://buy.stripe.com/fZucN7e7xgT85zBa708EM01', // Complete toolkit
                    description: "üéØ EVERYTHING BUNDLE:\n‚Ä¢ Complete Horror Toolkit\n‚Ä¢ All courses and templates\n‚Ä¢ Professional services"
                }
            };
            
            const cartKey = itemIds.join(',');
            
            // Check exact matches first
            if (bundles[cartKey]) {
                return {
                    hasBundle: true,
                    bundlePrice: bundles[cartKey].price,
                    paymentLink: bundles[cartKey].link,
                    description: bundles[cartKey].description
                };
            }
            
            // Check if cart contains complete toolkit (gets everything)
            if (itemIds.includes('toolkit')) {
                return {
                    hasBundle: true,
                    bundlePrice: 497,
                    paymentLink: 'https://buy.stripe.com/fZucN7e7xgT85zBa708EM01',
                    description: "üî• Complete Horror Toolkit includes ALL other products!\nYou're getting the best deal!"
                };
            }
            
            return { hasBundle: false };
        }

        function getSmartRecommendations(cartItems) {
            const itemIds = cartItems.map(item => item.id);
            
            // If they have masterclass, suggest templates and generator for writer's package
            if (itemIds.includes('masterclass') && !itemIds.includes('templates') && !itemIds.includes('generator')) {
                return ['Templates Bundle', 'Plot Generator'];
            }
            
            // If they have templates, suggest masterclass and generator
            if (itemIds.includes('templates') && !itemIds.includes('masterclass') && !itemIds.includes('generator')) {
                return ['Horror Masterclass', 'Plot Generator'];
            }
            
            // If they have any 2+ items but not toolkit, suggest toolkit as best value
            if (itemIds.length >= 2 && !itemIds.includes('toolkit')) {
                return ['Complete Horror Toolkit (includes everything!)'];
            }
            
            return [];
        }

        function showCartNotification(message) {
            // Simple notification - you can enhance this
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #4CAF50;
                color: white;
                padding: 15px 20px;
                border-radius: 5px;
                z-index: 1001;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                document.body.removeChild(notification);
            }, 3000);
        }

        // Initialize cart count on page load
        updateCartCount();

        // Close cart when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('cart-modal');
            if (event.target === modal) {
                closeCart();
            }
        }
        
        // Auto-open cart if URL has #cart
        if (window.location.hash === '#cart') {
            openCart();
        }
    </script>
    
    <!-- Real Stripe Payment Links -->
    <script src="payment-link-updater.js"></script>
</body>
</html>
